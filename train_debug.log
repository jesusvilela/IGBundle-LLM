
TorchAO import blocked for Windows compatibility.
Windows detected: Disabling Unsloth to avoid Triton errors.
Loading Qwen/Qwen2.5-7B (Unsloth: False)...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|##5       | 1/4 [00:06<00:20,  6.81s/it]
Loading checkpoint shards:  50%|#####     | 2/4 [00:25<00:27, 13.58s/it]
Loading checkpoint shards:  75%|#######5  | 3/4 [00:43<00:15, 15.68s/it]
Loading checkpoint shards: 100%|##########| 4/4 [00:59<00:00, 15.98s/it]
Loading checkpoint shards: 100%|##########| 4/4 [00:59<00:00, 14.94s/it]
Warning: The following arguments do not match the ones in the `trainer_state.json` within the checkpoint directory: 
	save_steps: 50 (from args) != 25 (from trainer_state.json)
Applying standard LoRA...
Injecting IGBundle adapters...
Detected model hidden_size: 3584
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)

IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
IGBundleAdapter: Using bottleneck_dim=256 (H=3584)
Checking parameter freezing status...
[DEBUG] Param: base_model.model.model.embed_tokens.weight, requires_grad: False
[DEBUG] Param: base_model.model.model.layers.0.original_block.self_attn.q_proj.base_layer.weight, requires_grad: False
[DEBUG] Param: base_model.model.model.layers.0.original_block.self_attn.q_proj.base_layer.bias, requires_grad: False
[DEBUG] Param: base_model.model.model.layers.0.original_block.self_attn.q_proj.lora_A.default.weight, requires_grad: True
[DEBUG] Param: base_model.model.model.layers.0.original_block.self_attn.q_proj.lora_B.default.weight, requires_grad: True
[DEBUG] Param: base_model.model.model.layers.0.original_block.self_attn.k_proj.base_layer.weight, requires_grad: False
[DEBUG] Param: base_model.model.model.layers.0.original_block.self_attn.k_proj.base_layer.bias, requires_grad: False
[DEBUG] Param: base_model.model.model.layers.0.original_block.self_attn.k_proj.lora_A.default.weight, requires_grad: True
[DEBUG] Param: base_model.model.model.layers.0.original_block.self_attn.k_proj.lora_B.default.weight, requires_grad: True
[DEBUG] Param: base_model.model.model.layers.0.original_block.self_attn.v_proj.base_layer.weight, requires_grad: False
[DEBUG] Param: base_model.model.model.layers.0.original_block.self_attn.v_proj.base_layer.bias, requires_grad: False
[DEBUG] Param: base_model.model.model.layers.0.original_block.self_attn.v_proj.lora_A.default.weight, requires_grad: True
Forced unfreezing on 952 parameters match 'adapter'/'igbundle'/'lora'.
trainable params: 72,112,460 || all params: 7,687,728,972 || trainable%: 0.9380
Loading yahma/alpaca-cleaned...
Formatting Alpaca dataset...
Tokenizing...
Starting training...
Resuming from existing checkpoints in ./output/igbundle_qwen7b_riemannian
  0%|          | 0/100 [00:00<?, ?it/s]
 27%|##7       | 27/100 [00:20<00:56,  1.30it/s]
                                                

 27%|##7       | 27/100 [00:20<00:56,  1.30it/s]
 28%|##8       | 28/100 [00:37<01:54,  1.59s/it]
                                                

 28%|##8       | 28/100 [00:37<01:54,  1.59s/it]
 29%|##9       | 29/100 [00:55<03:10,  2.68s/it]
                                                

 29%|##9       | 29/100 [00:55<03:10,  2.68s/it]
 30%|###       | 30/100 [01:14<04:42,  4.04s/it]
                                                

 30%|###       | 30/100 [01:14<04:42,  4.04s/it]
 31%|###1      | 31/100 [01:31<06:25,  5.58s/it]
                                                

 31%|###1      | 31/100 [01:31<06:25,  5.58s/it]
 32%|###2      | 32/100 [01:50<08:20,  7.35s/it]
                                                

 32%|###2      | 32/100 [01:50<08:20,  7.35s/it]
 33%|###3      | 33/100 [02:07<10:03,  9.01s/it]
                                                

 33%|###3      | 33/100 [02:07<10:03,  9.01s/it]
 34%|###4      | 34/100 [02:25<11:45, 10.69s/it]
                                                

 34%|###4      | 34/100 [02:25<11:45, 10.69s/it]
 35%|###5      | 35/100 [02:43<13:04, 12.07s/it]
                                                

 35%|###5      | 35/100 [02:43<13:04, 12.07s/it]
 36%|###6      | 36/100 [03:00<14:09, 13.28s/it]
                                                

 36%|###6      | 36/100 [03:00<14:09, 13.28s/it]
 37%|###7      | 37/100 [03:17<14:59, 14.28s/it]
                                                

 37%|###7      | 37/100 [03:17<14:59, 14.28s/it]
 38%|###8      | 38/100 [03:36<15:55, 15.42s/it]
                                                

 38%|###8      | 38/100 [03:36<15:55, 15.42s/it]
 39%|###9      | 39/100 [03:54<16:29, 16.23s/it]
                                                

 39%|###9      | 39/100 [03:54<16:29, 16.23s/it]
 40%|####      | 40/100 [04:12<16:45, 16.75s/it]
                                                

 40%|####      | 40/100 [04:12<16:45, 16.75s/it]
 41%|####1     | 41/100 [04:30<16:49, 17.11s/it]
                                                

 41%|####1     | 41/100 [04:30<16:49, 17.11s/it]
 42%|####2     | 42/100 [04:48<16:51, 17.44s/it]
                                                

 42%|####2     | 42/100 [04:48<16:51, 17.44s/it]
 43%|####3     | 43/100 [05:07<16:45, 17.65s/it]
                                                

 43%|####3     | 43/100 [05:07<16:45, 17.65s/it]
 44%|####4     | 44/100 [05:24<16:26, 17.62s/it]
                                                

 44%|####4     | 44/100 [05:24<16:26, 17.62s/it]
 45%|####5     | 45/100 [05:41<16:04, 17.53s/it]
                                                

 45%|####5     | 45/100 [05:41<16:04, 17.53s/it]
 46%|####6     | 46/100 [06:09<18:32, 20.60s/it]
                                                

 46%|####6     | 46/100 [06:09<18:32, 20.60s/it]
 47%|####6     | 47/100 [06:45<22:04, 25.00s/it]
                                                

 47%|####6     | 47/100 [06:45<22:04, 25.00s/it]
 48%|####8     | 48/100 [08:08<36:49, 42.50s/it]
                                                

 48%|####8     | 48/100 [08:08<36:49, 42.50s/it]
 49%|####9     | 49/100 [08:49<35:34, 41.85s/it]
                                                

 49%|####9     | 49/100 [08:49<35:34, 41.85s/it]
 50%|#####     | 50/100 [09:39<37:06, 44.54s/it]
                                                

 50%|#####     | 50/100 [09:39<37:06, 44.54s/it]
 51%|#####1    | 51/100 [10:37<39:35, 48.48s/it]
                                                

 51%|#####1    | 51/100 [10:37<39:35, 48.48s/it]
 52%|#####2    | 52/100 [11:59<46:51, 58.58s/it]
                                                

 52%|#####2    | 52/100 [11:59<46:51, 58.58s/it]
 53%|#####3    | 53/100 [14:09<1:02:36, 79.93s/it]
                                                  

 53%|#####3    | 53/100 [14:09<1:02:36, 79.93s/it]
 54%|#####4    | 54/100 [15:07<56:09, 73.24s/it]  
                                                

 54%|#####4    | 54/100 [15:07<56:09, 73.24s/it]
 55%|#####5    | 55/100 [15:59<50:07, 66.84s/it]
                                                

 55%|#####5    | 55/100 [15:59<50:07, 66.84s/it]
 56%|#####6    | 56/100 [16:47<44:53, 61.22s/it]
                                                

 56%|#####6    | 56/100 [16:47<44:53, 61.22s/it]
 57%|#####6    | 57/100 [18:46<56:23, 78.68s/it]
                                                

 57%|#####6    | 57/100 [18:46<56:23, 78.68s/it]
 58%|#####8    | 58/100 [20:12<56:38, 80.91s/it]
                                                

 58%|#####8    | 58/100 [20:12<56:38, 80.91s/it]
 59%|#####8    | 59/100 [21:27<54:06, 79.17s/it]
                                                

 59%|#####8    | 59/100 [21:27<54:06, 79.17s/it]
 60%|######    | 60/100 [23:26<1:00:39, 91.00s/it]
                                                  

 60%|######    | 60/100 [23:26<1:00:39, 91.00s/it]
 61%|######1   | 61/100 [24:59<59:28, 91.49s/it]  
                                                

 61%|######1   | 61/100 [24:59<59:28, 91.49s/it]
 62%|######2   | 62/100 [26:17<55:29, 87.62s/it]
                                                

 62%|######2   | 62/100 [26:17<55:29, 87.62s/it]
 63%|######3   | 63/100 [27:29<51:11, 83.02s/it]
                                                

 63%|######3   | 63/100 [27:29<51:11, 83.02s/it]
 64%|######4   | 64/100 [28:57<50:43, 84.53s/it]
                                                

 64%|######4   | 64/100 [28:57<50:43, 84.53s/it]
 65%|######5   | 65/100 [30:01<45:32, 78.08s/it]
                                                

 65%|######5   | 65/100 [30:01<45:32, 78.08s/it]
 66%|######6   | 66/100 [31:31<46:19, 81.76s/it]
                                                

 66%|######6   | 66/100 [31:31<46:19, 81.76s/it]
 67%|######7   | 67/100 [33:40<52:45, 95.93s/it]
                                                

 67%|######7   | 67/100 [33:40<52:45, 95.93s/it]
 68%|######8   | 68/100 [35:18<51:27, 96.48s/it]
                                                

 68%|######8   | 68/100 [35:18<51:27, 96.48s/it]
 69%|######9   | 69/100 [36:21<44:38, 86.42s/it]
                                                

 69%|######9   | 69/100 [36:21<44:38, 86.42s/it]
 70%|#######   | 70/100 [37:33<41:07, 82.24s/it]
                                                

 70%|#######   | 70/100 [37:33<41:07, 82.24s/it]
 71%|#######1  | 71/100 [38:36<36:57, 76.45s/it]
                                                

 71%|#######1  | 71/100 [38:36<36:57, 76.45s/it]
 72%|#######2  | 72/100 [39:18<30:53, 66.21s/it]
                                                

 72%|#######2  | 72/100 [39:18<30:53, 66.21s/it]
 73%|#######3  | 73/100 [40:06<27:16, 60.62s/it]
                                                

 73%|#######3  | 73/100 [40:06<27:16, 60.62s/it]
 74%|#######4  | 74/100 [41:01<25:31, 58.89s/it]
                                                

 74%|#######4  | 74/100 [41:01<25:31, 58.89s/it]
 75%|#######5  | 75/100 [42:22<27:20, 65.61s/it]
                                                

 75%|#######5  | 75/100 [42:22<27:20, 65.61s/it]
 76%|#######6  | 76/100 [43:12<24:22, 60.93s/it]
                                                

 76%|#######6  | 76/100 [43:12<24:22, 60.93s/it]
 77%|#######7  | 77/100 [44:18<23:53, 62.32s/it]
                                                

 77%|#######7  | 77/100 [44:18<23:53, 62.32s/it]
 78%|#######8  | 78/100 [45:05<21:10, 57.76s/it]
                                                

 78%|#######8  | 78/100 [45:05<21:10, 57.76s/it]
 79%|#######9  | 79/100 [45:48<18:41, 53.42s/it]
                                                

 79%|#######9  | 79/100 [45:48<18:41, 53.42s/it]
 80%|########  | 80/100 [46:46<18:15, 54.76s/it]
                                                

 80%|########  | 80/100 [46:46<18:15, 54.76s/it]
 81%|########1 | 81/100 [47:57<18:52, 59.60s/it]
                                                

 81%|########1 | 81/100 [47:57<18:52, 59.60s/it]
 82%|########2 | 82/100 [49:03<18:30, 61.71s/it]
                                                

 82%|########2 | 82/100 [49:03<18:30, 61.71s/it]
 83%|########2 | 83/100 [50:33<19:50, 70.06s/it]
                                                

 83%|########2 | 83/100 [50:33<19:50, 70.06s/it]
 84%|########4 | 84/100 [52:25<22:04, 82.77s/it]
                                                

 84%|########4 | 84/100 [52:25<22:04, 82.77s/it]
 85%|########5 | 85/100 [53:27<19:04, 76.31s/it]
                                                

 85%|########5 | 85/100 [53:27<19:04, 76.31s/it]
 86%|########6 | 86/100 [54:30<16:53, 72.41s/it]
                                                

 86%|########6 | 86/100 [54:30<16:53, 72.41s/it]
 87%|########7 | 87/100 [56:48<19:58, 92.21s/it]
                                                

 87%|########7 | 87/100 [56:49<19:58, 92.21s/it]
 88%|########8 | 88/100 [58:19<18:21, 91.77s/it]
                                                

 88%|########8 | 88/100 [58:19<18:21, 91.77s/it]
 89%|########9 | 89/100 [59:19<15:04, 82.27s/it]
                                                

 89%|########9 | 89/100 [59:19<15:04, 82.27s/it]
 90%|######### | 90/100 [1:00:28<13:02, 78.29s/it]
                                                  

 90%|######### | 90/100 [1:00:28<13:02, 78.29s/it]
 91%|#########1| 91/100 [1:01:40<11:26, 76.24s/it]
                                                  

 91%|#########1| 91/100 [1:01:40<11:26, 76.24s/it]
 92%|#########2| 92/100 [1:03:46<12:09, 91.14s/it]
                                                  

 92%|#########2| 92/100 [1:03:46<12:09, 91.14s/it]
 93%|#########3| 93/100 [1:06:22<12:55, 110.81s/it]
                                                   

 93%|#########3| 93/100 [1:06:22<12:55, 110.81s/it]
 94%|#########3| 94/100 [1:08:36<11:46, 117.71s/it]
                                                   

 94%|#########3| 94/100 [1:08:36<11:46, 117.71s/it]
 95%|#########5| 95/100 [1:10:21<09:28, 113.77s/it]
                                                   

 95%|#########5| 95/100 [1:10:21<09:28, 113.77s/it]
 96%|#########6| 96/100 [1:11:18<06:27, 96.99s/it] 
                                                  

 96%|#########6| 96/100 [1:11:18<06:27, 96.99s/it]
 97%|#########7| 97/100 [1:12:51<04:46, 95.52s/it]
                                                  

 97%|#########7| 97/100 [1:12:51<04:46, 95.52s/it]
 98%|#########8| 98/100 [1:13:46<02:47, 83.52s/it]
                                                  

 98%|#########8| 98/100 [1:13:46<02:47, 83.52s/it]
 99%|#########9| 99/100 [1:14:55<01:19, 79.16s/it]
                                                  

 99%|#########9| 99/100 [1:14:55<01:19, 79.16s/it]
100%|##########| 100/100 [1:16:01<00:00, 75.18s/it]
                                                   

100%|##########| 100/100 [1:16:01<00:00, 75.18s/it]
                                                   

100%|##########| 100/100 [1:16:07<00:00, 75.18s/it]
100%|##########| 100/100 [1:16:07<00:00, 45.68s/it]
